# テスト戦略

## ステータス

承認済み

## コンテキスト

プロジェクトの成長に伴い、品質保証とリファクタリングの安全性を確保するため、包括的なテスト戦略の策定が必要となった。フロントエンド、バックエンド、E2Eテストの各レイヤーで一貫した方針を定める必要がある。

## 決定

### ユニットテスト

#### 基本方針

- **コロケーション**を意識し、テスト対象に近い場所で管理する
- テスト対象ファイルと同階層に `__tests__/[ファイル名].test.ts` を作成する
- vitestのテストコードを記述する際、describe/testの名前は**日本語**で記述する
- **Parameterized test**での記述が望ましい場合は積極的に利用する
- `it('テスト名')` よりも `test('テスト名')` を利用する（日本語でテスト名を記述する場合testの方が自然なため）

#### Frontend固有

- テストコード中では**Nuxt.js環境**が利用可能な想定とする
- `@nuxt/test-utils`のNuxt環境を活用し、`useRuntimeConfig`等のNuxt関数を自然に使用
- バックエンドAPIの扱いは**TBD**

### フィーチャーテスト

現時点では**TBD**

### E2Eテスト

- `packages/frontend/tests`配下に**Playwright**によるテストを記述する
- この決定は今後backendのコードも書き始めた場合に適切とは限らないので、変更する可能性がある

## 根拠

### ユニットテスト

- **コロケーション**: テスト対象との距離を近くすることで、メンテナンス性と可読性を向上
- **日本語テスト名**: 業務要件を直接的に表現でき、非技術者でも理解しやすい
- **Nuxt環境**: モックを最小限に抑え、実際の動作により近いテストを実現

### E2Eテスト

- **Playwright**: モダンなE2Eテストツールとして安定性とパフォーマンスを両立
- **Frontend中心**: 現在のアーキテクチャに適合

## 結果・影響

### 正の影響

- テストの保守性向上
- 実際の動作により近いテスト環境
- 開発者の生産性向上

### 今後の課題

- バックエンドAPI連携テストの方針策定
- フィーチャーテストレイヤーの検討
- CI/CD環境でのテスト実行最適化

## 参考資料

- [認証に関するテスト戦略](docs/adr/ADR001-auth.md#testing-strategy)
- [@nuxt/test-utils公式ドキュメント](https://nuxt.com/docs/getting-started/testing)
