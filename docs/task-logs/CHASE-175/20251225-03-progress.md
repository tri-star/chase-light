# èª²é¡Œ1ãƒ»èª²é¡Œ2ã®å®Ÿè£…é€²æ—çŠ¶æ³

ä½œæˆæ—¥: 2025-12-25
æœ€çµ‚æ›´æ–°: 2025-12-25 22:46ï¼ˆãƒ†ã‚¹ãƒˆä¿®æ­£ä¸­ï¼‰

## é€²æ—ã‚µãƒãƒªãƒ¼

| ã‚¿ã‚¹ã‚¯ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | å‚™è€ƒ |
|--------|-----------|------|
| èª²é¡Œ1: hasTranslatedBodyãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¿½åŠ  | âœ… å®Œäº† | 3ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£å®Œäº† |
| èª²é¡Œ2-1: DB Migration | âœ… å®Œäº† | ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œæ¸ˆã¿ |
| èª²é¡Œ2-2: Shared Constantsæ›´æ–° | âœ… å®Œäº† | IDLEè¿½åŠ æ¸ˆã¿ |
| èª²é¡Œ2-3: Backend Validation Schemaæ›´æ–° | âœ… å®Œäº† | Zod schemaæ›´æ–°å®Œäº† |
| èª²é¡Œ2-4: Backend API Responseæ›´æ–° | âœ… å®Œäº† | Repository/Schema/Mapperæ›´æ–°å®Œäº† |
| èª²é¡Œ2-5: Frontend Composableæ›´æ–° | âœ… å®Œäº† | useTranslationRequestæ›´æ–°å®Œäº† |
| Lint/Format | âœ… å®Œäº† | Backend/Frontendä¸¡æ–¹æˆåŠŸ |
| ãƒ†ã‚¹ãƒˆ | ğŸ”„ ä½œæ¥­ä¸­ | Frontend 2ä»¶å¤±æ•—ä¸­ã€ä¿®æ­£ä¸­ |
| å‹•ä½œç¢ºèªï¼ˆæ‰‹å‹•ãƒ†ã‚¹ãƒˆï¼‰ | â³ æœªç€æ‰‹ | ãƒ†ã‚¹ãƒˆæˆåŠŸå¾Œã«å®Ÿæ–½ |

---

## âœ… å®Œäº†ã—ãŸä½œæ¥­

### èª²é¡Œ1: hasTranslatedBodyãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¿½åŠ ï¼ˆå®Œäº†ï¼‰

#### å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

1. **`packages/frontend/components/pages/activities/detail/use-activity-detail.ts`**
   - 35-37è¡Œç›®ã«`hasTranslatedBody` computedè¿½åŠ 
   - 76è¡Œç›®ã«returnå€¤ã¨ã—ã¦`hasTranslatedBody`è¿½åŠ 

2. **`packages/frontend/components/pages/activities/detail/ActivityDetailPage.vue`**
   - 19è¡Œç›®: `hasTranslatedBody`ã‚’`useActivityDetail`ã‹ã‚‰å—ã‘å–ã‚‹
   - 60è¡Œç›®: `ActivityDetailContent`ã«`:has-translated-body`propsã‚’æ¸¡ã™

3. **`packages/frontend/components/pages/activities/detail/parts/ActivityDetailContent.vue`**
   - 13è¡Œç›®: `hasTranslatedBody: boolean`ã‚’propsã«è¿½åŠ 
   - 28-36è¡Œç›®: `showTranslationBanner`ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’`hasTranslatedBody`ã‚’ä½¿ã†ã‚ˆã†ã«ä¿®æ­£

#### å®Ÿè£…å†…å®¹

```typescript
// use-activity-detail.ts:35-37
const hasTranslatedBody = computed(
  () => !!(activity.value?.translatedBody && activity.value.translatedBody !== '')
)
```

```typescript
// ActivityDetailContent.vue:28-36
const showTranslationBanner = computed(() => {
  // ç¿»è¨³æ¸ˆã¿æœ¬æ–‡ãŒãªã„å ´åˆã«è¡¨ç¤º
  // ãŸã ã—ã€ç¿»è¨³å®Œäº†çŠ¶æ…‹ã®å ´åˆã¯éè¡¨ç¤ºï¼ˆãƒ‡ãƒ¼ã‚¿å†å–å¾—å¾Œã«ç¿»è¨³çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŸã‚ï¼‰
  return (
    !props.hasTranslatedBody &&
    props.translationStatus &&
    props.translationStatus !== 'completed'
  )
})
```

---

### èª²é¡Œ2-1: DB Migrationï¼ˆå®Œäº†ï¼‰

#### å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

1. **`packages/backend/src/db/schema.ts`**
   - 157-159è¡Œç›®: `bodyTranslationStatus`ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’`"completed"`â†’`"idle"`ã«å¤‰æ›´

2. **`packages/backend/src/db/migrations/0012_slimy_cyclops.sql`**ï¼ˆè‡ªå‹•ç”Ÿæˆ + æ‰‹å‹•è¿½åŠ ï¼‰
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤å¤‰æ›´ã®ALTER TABLEæ–‡
   - **æ‰‹å‹•è¿½åŠ **: æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã®`body_translation_status`ã‚’"idle"ã«æ›´æ–°ã™ã‚‹UPDATEæ–‡

#### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å†…å®¹

```sql
DROP INDEX "idx_activities_body_translation_requested_at";
ALTER TABLE "activities" ALTER COLUMN "body_translation_status" SET DEFAULT 'idle';
UPDATE "activities" SET "body_translation_status" = 'idle' WHERE "translated_body" IS NULL;
CREATE INDEX "idx_activities_body_translation_requested_at" ON "activities" USING btree ("body_translation_requested_at" DESC);
```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
pnpm --filter backend db:generate  # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
# æ‰‹å‹•ã§UPDATEæ–‡ã‚’è¿½åŠ 
pnpm --filter backend db:migrate   # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ âœ… æˆåŠŸ
```

---

### èª²é¡Œ2-2: Shared Constantsæ›´æ–°ï¼ˆå®Œäº†ï¼‰

#### å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

**`packages/shared/src/constants/activity-translation.ts`**

#### å¤‰æ›´å†…å®¹

```typescript
export const ACTIVITY_BODY_TRANSLATION_STATUS = {
  IDLE: "idle",        // â† è¿½åŠ 
  QUEUED: "queued",
  PROCESSING: "processing",
  COMPLETED: "completed",
  FAILED: "failed",
} as const
```

---

## ğŸ”„ ä½œæ¥­ä¸­ã®ã‚¿ã‚¹ã‚¯

### èª²é¡Œ2-3: Backend Validation Schemaæ›´æ–°

#### å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

**`packages/backend/src/features/activities/infra/repositories/drizzle-activity-translation-state.repository.ts`**

#### å¿…è¦ãªå¤‰æ›´

20-28è¡Œç›®ã®`activityTranslationRowSchema`ã«`IDLE`ã‚’è¿½åŠ :

```typescript
const activityTranslationRowSchema = z.object({
  activityId: z.string(),
  body: z.string(),
  translationStatus: z.enum([
    ACTIVITY_BODY_TRANSLATION_STATUS.IDLE,      // â† è¿½åŠ 
    ACTIVITY_BODY_TRANSLATION_STATUS.QUEUED,
    ACTIVITY_BODY_TRANSLATION_STATUS.PROCESSING,
    ACTIVITY_BODY_TRANSLATION_STATUS.COMPLETED,
    ACTIVITY_BODY_TRANSLATION_STATUS.FAILED,
  ]),
  // ...
})
```

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å®Œäº†ã€ç·¨é›†å‰ã§ä¸­æ–­

---

## â³ æœªç€æ‰‹ã®ã‚¿ã‚¹ã‚¯

### èª²é¡Œ2-4: Backend API Responseæ›´æ–°

#### å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

1. **`packages/backend/src/features/activities/infra/repositories/drizzle-activity-query.repository.ts`**
   - 208-231è¡Œç›®ã®`selectBaseFields()`ã«`bodyTranslationStatus`ã‚’è¿½åŠ 

#### å¿…è¦ãªå¤‰æ›´

```typescript
private selectBaseFields() {
  return {
    activityId: activities.id,
    // ... ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    translatedBody: activities.translatedBody,
    bodyTranslationStatus: activities.bodyTranslationStatus,  // â† è¿½åŠ 
    status: activities.status,
    // ...
  }
}
```

2. **å¯¾å¿œã™ã‚‹ã‚¹ã‚­ãƒ¼ãƒãƒ»å‹å®šç¾©ã®æ›´æ–°**
   - ActivityDetailå‹ã«`bodyTranslationStatus`ã‚’è¿½åŠ 
   - OpenAPIã‚¹ã‚­ãƒ¼ãƒã®æ›´æ–°ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

---

### èª²é¡Œ2-5: Frontend Composableæ›´æ–°

#### å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

1. **`packages/frontend/features/activities/composables/use-translation-request.ts`**

#### å¿…è¦ãªå¤‰æ›´

```typescript
export function useTranslationRequest(
  activityId: string,
  initialStatus?: TranslationRequestStatus  // â† å¼•æ•°è¿½åŠ 
) {
  const status = ref<TranslationRequestStatus>(initialStatus ?? 'idle')
  // ...
}
```

2. **å‘¼ã³å‡ºã—å´ã®ä¿®æ­£**

**`packages/frontend/components/pages/activities/detail/ActivityDetailPage.vue`**

```typescript
const {
  status: translationStatus,
  errorMessage: translationErrorMessage,
  requestTranslation,
  onTranslationComplete,
} = useTranslationRequest(
  props.activityId,
  activity.value?.bodyTranslationStatus  // â† å¼•æ•°è¿½åŠ 
)
```

3. **Frontend BFFå´ã®å‹å®šç¾©ç¢ºèª**
   - `packages/frontend/server/api/activities/[id].get.ts`
   - Backend APIã®`bodyTranslationStatus`ã‚’ãã®ã¾ã¾è¿”ã™ã‹ç¢ºèª
   - Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

---

### å‹•ä½œç¢ºèªï¼ˆæ‰‹å‹•ãƒ†ã‚¹ãƒˆï¼‰

#### ç¢ºèªé …ç›®

1. **èª²é¡Œ1ã®ç¢ºèª**:
   - `translated_body`ãŒ`null`ã®å ´åˆã«ç¿»è¨³ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒŠãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
   - `translated_title`ã®ã¿ãŒã‚ã‚‹å ´åˆã‚‚ãƒãƒŠãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹

2. **èª²é¡Œ2ã®ç¢ºèª**:
   - æ–°è¦ä½œæˆã•ã‚ŒãŸã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®`body_translation_status`ãŒ"idle"ã«ãªã£ã¦ã„ã‚‹ã‹
   - æ—¢å­˜ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ï¼ˆ`translated_body`ãŒ`null`ï¼‰ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ"idle"ã«æ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹
   - Frontend UIã§"idle"çŠ¶æ…‹ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‹

3. **æ—¢å­˜æ©Ÿèƒ½ã®ç¢ºèª**:
   - åŸæ–‡/ç¿»è¨³çµæœã®åˆ‡ã‚Šæ›¿ãˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‹
   - ç¿»è¨³ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‹

---

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¨Lint/Format

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# Frontend
pnpm --filter frontend test
pnpm --filter frontend lint
pnpm --filter frontend format

# Backend
pnpm --filter backend test
pnpm --filter backend lint
pnpm --filter backend format

# å…¨ä½“
pnpm format
pnpm lint
```

---

## æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿæ–½ã™ã‚‹ã“ã¨

1. **èª²é¡Œ2-3ã®ç¶šã**: Backend Validation Schemaæ›´æ–°
   - `drizzle-activity-translation-state.repository.ts`ã®ç·¨é›†

2. **èª²é¡Œ2-4**: Backend API Responseæ›´æ–°
   - `drizzle-activity-query.repository.ts`ã®ä¿®æ­£
   - å‹å®šç¾©ã®æ›´æ–°

3. **èª²é¡Œ2-5**: Frontend Composableæ›´æ–°
   - `use-translation-request.ts`ã®ä¿®æ­£
   - `ActivityDetailPage.vue`ã®å‘¼ã³å‡ºã—å´ä¿®æ­£

4. **å‹•ä½œç¢ºèª**: æ‰‹å‹•ãƒ†ã‚¹ãƒˆã§2ã¤ã®èª²é¡ŒãŒè§£æ±ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

5. **ãƒ†ã‚¹ãƒˆãƒ»Lint**: å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¨Lint/Format

6. **ã‚³ãƒŸãƒƒãƒˆ**: conventional commitã«å¾“ã£ã¦ã‚³ãƒŸãƒƒãƒˆä½œæˆ

---

## é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ä¸€è¦§

### Frontend

- `packages/frontend/components/pages/activities/detail/use-activity-detail.ts`
- `packages/frontend/components/pages/activities/detail/ActivityDetailPage.vue`
- `packages/frontend/components/pages/activities/detail/parts/ActivityDetailContent.vue`
- `packages/frontend/features/activities/composables/use-translation-request.ts`
- `packages/frontend/server/api/activities/[id].get.ts`

### Backend

- `packages/backend/src/db/schema.ts`
- `packages/backend/src/db/migrations/0012_slimy_cyclops.sql`
- `packages/backend/src/features/activities/infra/repositories/drizzle-activity-query.repository.ts`
- `packages/backend/src/features/activities/infra/repositories/drizzle-activity-translation-state.repository.ts`

### Shared

- `packages/shared/src/constants/activity-translation.ts`

---

## å‚™è€ƒ

- DB Migrationã¯æ—¢ã«å®Ÿè¡Œæ¸ˆã¿ã®ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«DBã«ã¯"idle"çŠ¶æ…‹ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹
- èª²é¡Œ1ã¯å®Œå…¨ã«ç‹¬ç«‹ã—ã¦ã„ã‚‹ãŸã‚ã€èª²é¡Œ2ãŒå®Œäº†ã—ãªãã¦ã‚‚å‹•ä½œã™ã‚‹
- èª²é¡Œ2ã¯Backendâ†’Frontendã®é †ã§å®Ÿè£…ã‚’é€²ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹

---

## ğŸ”„ ç¾åœ¨ã®å•é¡Œï¼ˆ2025-12-25 22:46æ™‚ç‚¹ï¼‰

### Frontend ãƒ†ã‚¹ãƒˆå¤±æ•—ï¼ˆ2ä»¶ï¼‰

**å¤±æ•—ãƒ†ã‚¹ãƒˆ1**: ã€Œç¿»è¨³ãŒãªã„å ´åˆã€ç¿»è¨³ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒŠãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€
**å¤±æ•—ãƒ†ã‚¹ãƒˆ2**: ã€Œç¿»è¨³ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ç¿»è¨³ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã‚‹ã€

#### å•é¡Œã®è©³ç´°

- ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«: `packages/frontend/components/pages/activities/detail/__tests__/activity-detail.test.ts`
- ä¸¡æ–¹ã®ãƒ†ã‚¹ãƒˆã§`bodyTranslationStatus: 'idle'`ã‚’è¿½åŠ ã—ãŸãŒã€ãƒãƒŠãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:
  ```
  AssertionError: expected false to be true
  const banner = wrapper.find('[data-testid="translation-request-banner"]')
  expect(banner.exists()).toBe(true)  // â† false ãŒè¿”ã‚‹
  ```

#### èª¿æŸ»ä¸­ã®å†…å®¹

1. **ãƒãƒŠãƒ¼è¡¨ç¤ºæ¡ä»¶**ï¼ˆ`ActivityDetailContent.vue:28-36`ï¼‰:
   ```typescript
   const showTranslationBanner = computed(() => {
     return (
       !props.hasTranslatedBody &&
       props.translationStatus &&
       props.translationStatus !== 'completed'
     )
   })
   ```

2. **åˆæœŸå€¤ã®å¤‰æ›**ï¼ˆ`ActivityDetailPage.vue:31-48`ï¼‰:
   ```typescript
   const mapToTranslationStatus = (
     backendStatus: string | undefined
   ): TranslationRequestStatus | undefined => {
     if (!backendStatus) return undefined
     if (backendStatus === 'idle' || ...) {
       return backendStatus as TranslationRequestStatus
     }
     // ...
   }

   const { status: translationStatus, ... } = useTranslationRequest(
     props.activityId,
     mapToTranslationStatus(activity.value?.bodyTranslationStatus)
   )
   ```

3. **è€ƒãˆã‚‰ã‚Œã‚‹åŸå› **:
   - ãƒ†ã‚¹ãƒˆã®ãƒ¢ãƒƒã‚¯ã§`bodyTranslationStatus`ãŒæ­£ã—ã`ActivityDetail`å‹ã«å«ã¾ã‚Œã¦ã„ãªã„å¯èƒ½æ€§
   - `useTranslationRequest`ãŒãƒ†ã‚¹ãƒˆç’°å¢ƒã§æ­£ã—ãåˆæœŸåŒ–ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§
   - `mapToTranslationStatus`ãŒ`undefined`ã‚’è¿”ã—ã¦ã„ã‚‹å¯èƒ½æ€§
   - `activity.value`ã®å–å¾—ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®å•é¡Œï¼ˆ`await useActivityDetail`å¾Œã®éåŒæœŸå‡¦ç†ï¼‰

#### å®Ÿæ–½ã—ãŸä¿®æ­£

1. `buildActivity`é–¢æ•°ã§ç”Ÿæˆã™ã‚‹ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«`bodyTranslationStatus: 'completed'`ã‚’è¿½åŠ ï¼ˆè¡Œ37ï¼‰
2. Storybookã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«`bodyTranslationStatus: 'completed'`ã‚’è¿½åŠ 
3. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§`bodyTranslationStatus: 'idle'`ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰æŒ‡å®šï¼ˆè¡Œ128, 157ï¼‰

#### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. ãƒ†ã‚¹ãƒˆã®ãƒ¢ãƒƒã‚¯è¨­å®šã‚’è©³ç´°ç¢ºèª
   - `fetchMock`ãŒè¿”ã™`ActivityDetail`å‹ã«`bodyTranslationStatus`ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹
   - `activity.value?.bodyTranslationStatus`ãŒå®Ÿéš›ã«`'idle'`ã«ãªã£ã¦ã„ã‚‹ã‹
2. `useTranslationRequest`ã®åˆæœŸåŒ–ã‚’ç¢ºèª
   - ãƒ†ã‚¹ãƒˆç’°å¢ƒã§`initialStatus`ãŒæ­£ã—ãæ¸¡ã•ã‚Œã¦ã„ã‚‹ã‹
   - `status` refã®åˆæœŸå€¤ãŒ`'idle'`ã«ãªã£ã¦ã„ã‚‹ã‹
3. ãƒãƒŠãƒ¼è¡¨ç¤ºã®ãƒ‡ãƒãƒƒã‚°
   - `hasTranslatedBody`ã®å€¤ã‚’ç¢ºèª
   - `translationStatus`ã®å€¤ã‚’ç¢ºèª
   - `showTranslationBanner`ãŒ`false`ã«ãªã‚‹ç†ç”±ã‚’ç‰¹å®š

---

## å®Ÿè£…æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ï¼ˆèª²é¡Œ2-3ä»¥é™ï¼‰

### Backend

#### èª²é¡Œ2-3: Validation Schema
- `packages/backend/src/features/activities/infra/repositories/drizzle-activity-translation-state.repository.ts`
  - `activityTranslationRowSchema`ã«`IDLE`ã‚’è¿½åŠ ï¼ˆ24è¡Œç›®ï¼‰

#### èª²é¡Œ2-4: API Response
- `packages/backend/src/features/activities/infra/repositories/drizzle-activity-query.repository.ts`
  - importè¿½åŠ ï¼ˆ26è¡Œç›®ï¼‰
  - `BaseActivityRow`å‹ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ40è¡Œç›®ï¼‰
  - `selectBaseFields()`ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ218è¡Œç›®ï¼‰
  - `mapToListItem()`ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ337è¡Œç›®ï¼‰
  - `mapToDomain()`ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ198è¡Œç›®ï¼‰

- `packages/backend/src/features/activities/domain/activity.ts`
  - importè¿½åŠ ï¼ˆ5è¡Œç›®ï¼‰
  - `ActivityListItemSummary`å‹ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ95è¡Œç›®ï¼‰

- `packages/backend/src/features/activities/presentation/schemas/activity-detail-response.schema.ts`
  - `activityDetailSchema`ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ33-38è¡Œç›®ï¼‰

- `packages/backend/src/features/activities/presentation/schemas/activity-translation.schema.ts`
  - `translationStatusSchema`ã«`IDLE`è¿½åŠ ï¼ˆ19è¡Œç›®ï¼‰

- `packages/backend/src/features/activities/presentation/utils/response-mapper.ts`
  - `mapToListItem()`ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ41è¡Œç›®ï¼‰
  - `mapToActivityDetail()`ã«`bodyTranslationStatus`è¿½åŠ ï¼ˆ77è¡Œç›®ï¼‰

- `packages/backend/src/features/activities/application/use-cases/__tests__/get-activity-detail.use-case.test.ts`
  - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«`bodyTranslationStatus: 'idle'`è¿½åŠ ï¼ˆ25è¡Œç›®ï¼‰

#### OpenAPI/Orval
- `pnpm --filter backend openapi:update` å®Ÿè¡Œæ¸ˆã¿
- `pnpm orval` å®Ÿè¡Œæ¸ˆã¿ï¼ˆFrontendå´ã§APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‹ç”Ÿæˆï¼‰

### Frontend

#### èª²é¡Œ2-5: Composable
- `packages/frontend/features/activities/composables/use-translation-request.ts`
  - `useTranslationRequest`ã«`initialStatus`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¿½åŠ ï¼ˆ25è¡Œç›®ï¼‰
  - `status` refã®åˆæœŸå€¤ã‚’`initialStatus ?? 'idle'`ã«å¤‰æ›´ï¼ˆ27è¡Œç›®ï¼‰

- `packages/frontend/components/pages/activities/detail/ActivityDetailPage.vue`
  - `TranslationRequestStatus`å‹ã®importè¿½åŠ ï¼ˆ9è¡Œç›®ï¼‰
  - `mapToTranslationStatus`é–¢æ•°è¿½åŠ ï¼ˆ31-48è¡Œç›®ï¼‰
  - `useTranslationRequest`å‘¼ã³å‡ºã—ã§åˆæœŸå€¤ã‚’æ¸¡ã™ã‚ˆã†ã«å¤‰æ›´ï¼ˆ55-58è¡Œç›®ï¼‰

#### ãƒ†ã‚¹ãƒˆ/Storybook
- `packages/frontend/components/pages/activities/detail/__tests__/activity-detail.test.ts`
  - `buildActivity`ã«`bodyTranslationStatus: 'completed'`è¿½åŠ ï¼ˆ37è¡Œç›®ï¼‰
  - ç¿»è¨³ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ†ã‚¹ãƒˆã«`bodyTranslationStatus: 'idle'`è¿½åŠ ï¼ˆ128, 157è¡Œç›®ï¼‰

- `packages/frontend/components/pages/activities/detail/ActivityDetailPage.stories.ts`
  - ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«`bodyTranslationStatus: 'completed'`è¿½åŠ ï¼ˆ90è¡Œç›®ï¼‰
