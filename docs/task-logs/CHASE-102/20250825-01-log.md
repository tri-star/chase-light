# CHASE-102 デザイントークンのプレビューページ、LLM用デザイントークンJSONの作成

## 作業概要

デザイントークンからTailwindのテーマ定義を作成するシステムが導入されたが、以下の課題を解決する：

- デザイントークンをメンテナンスする際の目視確認可能なプレビュー画面の実装
- LLM向けのTailwindユーティリティクラス使用指針JSONの自動生成
- デザイントークンとTailwindクラスの不整合を早期発見する仕組みの構築

最終的に、Tailwind v4のJIT制約を回避するCSS変数ベース実装により、7カテゴリすべてのStorybookプレビューページとLLMドキュメント自動生成を実現する。

## 実装計画

### デザイントークンプレビューシステム

1. **Storybookデザインシステムプレビューページ**: `components/design-systems/`配下に7カテゴリ（color, typography, spacing, sizing, borders, shadows, transitions）のストーリーファイルを作成
2. **動的データ取得機能**: `DesignTokenHelper`クラスによりTailwind CSS変数から動的にプレビューデータを生成
3. **CSS変数ベース表示**: JIT制約回避のため、CSS変数を直接利用し、ユーザーには対応Tailwindクラス名を表示

### LLMドキュメント自動生成機能

1. **`LLMDocGenerator`クラス**: 各カテゴリのTailwindユーティリティクラス利用指針を構造化JSONで出力
2. **既存コンバーターとの統合**: デザイントークン変換時に自動的にLLMドキュメントも生成

## 実装手順

1. **Phase 1**: 基盤構築
   - `components/design-systems/`ディレクトリ作成
   - 共通レイアウトパターンの検討
   - Storybookでのディレクトリ構成確認

2. **Phase 2**: カラーシステム実装
   - 基本実装（Tailwindクラス利用）
   - JIT問題発生→CSS変数ベース実装への転換
   - Semantic Colors完全対応（Status/Surface/Header/Sidebar/Dialog等全カテゴリ）

3. **Phase 3**: タイポグラフィシステム実装
   - フォントファミリー・スケール・セマンティックタイポグラフィの表示

4. **Phase 4**: スペーシング・サイジングシステム実装
   - スペーシングスケールの視覚化
   - サイズスケール・レスポンシブサイズの表示

5. **Phase 5**: その他要素システム実装
   - Border（幅・角丸）、Shadow、Transitionの表示・視覚化

6. **Phase 6**: LLMドキュメント生成機能実装
   - `LLMDocGenerator`クラス実装とコンバーター統合

7. **Phase 7**: 統合テスト・調整
   - 全体表示確認・不整合検出・最終調整

## 実装詳細

### 実装内容

#### Phase 2での技術的方針転換（重要）

**第1段階（基本実装）**:

- プリミティブ・セマンティックカラーをTailwindクラスで実装
- CSS変数命名問題の解決（`--background-color-*`, `--text-color-*`, `--border-color-*`への適切なマッピング）

**第2段階（JIT問題→CSS変数ベース実装への転換）**:

- **問題**: Tailwind v4 JITで動的生成クラス（`v-for`等）が適用されない
- **解決**: CSS変数直接利用（`var(--color-primitive-blue-500)`）+ Tailwindクラス名表示の分離

**第3段階（Semantic Colors完全対応）**:

- Status Colors全バリアント対応（Info/Success/Warning/Error × Default/Subtle/Inversed）
- Surface/Header/Sidebar/Dialog Colors追加
- CSS変数フォールバック機能実装

#### CSS変数ベース実装の技術仕様

- **表示**: Vue.js `:style`バインディングでCSS変数直接参照
- **ユーザー表示**: `cssVarToTailwindClass`メソッドで対応Tailwindクラス名を表示
- **フォールバック**: 存在しないCSS変数は適切なtypeに変換生成（`generateFallbackCssVar`）

### 変更ファイル

- `components/design-systems/design-token-helper.ts`
  - `PrimitiveColorInfo`/`SemanticColorInfo`インターフェース定義
  - `DesignTokenHelper`クラス: 動的データ取得機能
  - `cssVarToTailwindClass`: CSS変数名→Tailwindクラス名変換
  - `groupSemanticTokens`: semantic color構造の正確な解析
  - `generateFallbackCssVar`: 不足CSS変数の適切な生成

- `components/design-systems/colors.stories.ts`
  - 完全書き換え（800+行ハードコード→動的データ化）
  - ThemeToggle, PrimitiveColors, SemanticColorsコンポーネント実装
  - CSS変数ベース表示 + Tailwindクラス名提示

- `scripts/design-token-converter/token-parser.ts`
  - `generateSemanticCSSVarName`メソッド: セマンティックCSS変数マッピング

## 進捗状況

- [x] **Phase 1**: 基盤構築
  - [x] `components/design-systems/`ディレクトリ作成
  - [x] 共通レイアウトパターンの検討
  - [x] Storybookでのディレクトリ構成確認

- [x] **Phase 2**: カラーシステム実装
  - [x] 基本実装（Tailwindクラス利用）
  - [x] JIT問題発生→CSS変数ベース実装への転換
  - [x] Semantic Colors完全対応（Status/Surface/Header/Sidebar/Dialog等全カテゴリ）

- [ ] **Phase 3**: タイポグラフィシステム実装
  - [ ] フォントファミリー・スケール・セマンティックタイポグラフィの表示

- [ ] **Phase 4**: スペーシング・サイジングシステム実装
  - [ ] スペーシングスケールの視覚化
  - [ ] サイズスケール・レスポンシブサイズの表示

- [ ] **Phase 5**: その他要素システム実装
  - [ ] Border（幅・角丸）表示
  - [ ] Shadow表示・視覚化
  - [ ] Transition表示・視覚化

- [ ] **Phase 6**: LLMドキュメント生成機能実装
  - [ ] `LLMDocGenerator`クラス実装
  - [ ] コンバーター統合

- [ ] **Phase 7**: 統合テスト・調整
  - [ ] 全体表示確認・不整合検出・最終調整

## 残っている課題

### 次のステップ

1. **Phase 3**: タイポグラフィシステム実装（フォントファミリー・スケール・セマンティックタイポグラフィ）
2. **Phase 4-5**: スペーシング・サイジング・Border・Shadow・Transitionシステム実装
3. **Phase 6**: LLMドキュメント生成機能実装
4. **Phase 7**: 統合テスト・最終調整

### 技術的制約・注意点

- **Tailwind v4 JIT制約**: 動的コンテンツではCSS変数が確実、クラス名は表示用に分離
- **デザイントークン構造の複雑性**: 3層構造の正確な把握が必要（Status: `common.{status}.{variant}.{property}`）
- **CSS変数命名規則**: `--{type}-color-{semantic-path}`でtype別明確化、フォールバック戦略の確立

### 実装除外項目

- デザイントークン自体の変更・追加
- 新しいTailwindクラスの追加
