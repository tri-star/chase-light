# CHASE-201: アクティビティ一覧APIにキーワード検索機能を追加 - 作業ログ

## 作業概要

アクティビティ一覧API (`GET /api/activities`) にキーワード検索機能を追加する。

## 実装計画

### Phase 1: Domain層・Application層実装
- [ ] 1-1. `domain/activity.ts` の `ActivitiesListFilters` 型に `keyword?: string` を追加
- [ ] 1-2. `application/use-cases/list-activities.helpers.ts` の型と正規化ロジックを更新
  - [ ] `ActivitiesListInputOptions` 型に `keyword?: string` を追加
  - [ ] `normalizeActivitiesListOptions` で `keyword` を `filters` に含める
- [ ] 1-3. format, lint, test
- [ ] 1-4. コミット

### Phase 2: Infra層実装
- [ ] 2-1. `infra/repositories/drizzle-activity-query.repository.ts` の `buildWhereClause` にILIKE検索条件を追加
  - [ ] drizzle-ormの `ilike`, `or` 関数を使用
  - [ ] 検索対象フィールド:
    - [ ] activities.title
    - [ ] activities.translated_title
    - [ ] activities.translated_body
    - [ ] activities.summary
    - [ ] activities.version
    - [ ] data_sources.name
    - [ ] repositories.full_name
- [ ] 2-2. format, lint, test
- [ ] 2-3. コミット

### Phase 3: Presentation層実装
- [ ] 3-1. `presentation/schemas/activity-list-request.schema.ts` に `keyword` スキーマを追加（オプション、文字列、1-100文字）
- [ ] 3-2. `presentation/routes/activities/index.ts` でユースケースに `keyword` を渡す
- [ ] 3-3. Component Testの作成・実行
  - [ ] キーワードでアクティビティタイトルを検索し、該当結果が返ること
  - [ ] キーワードで翻訳本文を検索し、該当結果が返ること
  - [ ] キーワードでデータソース名を検索し、該当結果が返ること
  - [ ] キーワードでリポジトリ名を検索し、該当結果が返ること
  - [ ] 大文字小文字を区別せずに検索できること（ILIKE動作確認）
  - [ ] 該当なしの場合は空配列が返ること
  - [ ] keywordパラメータなしの場合は従来通りの動作をすること
  - [ ] keywordが空文字の場合は無視されること
- [ ] 3-4. OpenAPI仕様書の更新 (`pnpm openapi:update`)
- [ ] 3-5. format, lint, test
- [ ] 3-6. コミット

### 最終確認
- [ ] 全テストが通過
- [ ] lint/formatエラーなし
- [ ] push
- [ ] PR作成

## 作業メモ

### 懸念事項
- なし

### 議論した内容
- なし

### 実装の詳細
