# 作業ログ: CHASE-185 ActivityルートのDI簡素化とテスト初期化の改善

## 作業情報

- **作業日**: 2025-12-10
- **課題ID**: CHASE-185
- **SOW**: `docs/sow/20251210-CHASE-185.md`

## 実装計画

### 概要

Activity系ルートのDI方式を「デフォルト依存セット + 部分オーバーライド方式」に変更し、テスト初期化を簡素化する。

### 作業チェックリスト

#### Phase 1: 依存組み立て関数の作成

- [x] `ActivityDeps` 型を定義
- [x] `buildActivityDeps()` 関数を実装
- [x] `packages/backend/src/features/activities/application/activity-deps.ts` に作成

#### Phase 2: ルート関数のシグネチャ変更

- [x] `createActivityPresentationRoutes` を `deps: ActivityDeps` 引数に変更
- [x] `createActivitiesRoutes` を `deps: Pick<ActivityDeps, ...>` 引数に変更
- [x] `createDataSourceActivitiesRoutes` を `deps: Pick<ActivityDeps, ...>` 引数に変更
- [x] `index.ts` の呼び出し方法を更新

#### Phase 3: テストファクトリの作成と既存テスト更新

- [x] `createActivityTestApp()` 関数を実装 (`presentation/test-helpers/create-activity-test-app.ts`)
- [x] `routes/activities/__tests__/index.test.ts` を更新
- [x] `routes/data-source-activities/__tests__/index.test.ts` を更新

#### 最終確認

- [x] 全テスト実行・確認
- [x] Lint/Format確認
- [x] コミット・Push・PR作成

## PR

- https://github.com/tri-star/chase-light/pull/206

## 変更対象ファイル一覧

### 新規作成

1. `packages/backend/src/features/activities/application/activity-deps.ts`
2. `packages/backend/src/features/activities/presentation/test-helpers/create-activity-test-app.ts`

### 更新

1. `packages/backend/src/features/activities/index.ts`
2. `packages/backend/src/features/activities/presentation/routes.ts`
3. `packages/backend/src/features/activities/presentation/routes/activities/index.ts`
4. `packages/backend/src/features/activities/presentation/routes/data-source-activities/index.ts`
5. `packages/backend/src/features/activities/presentation/routes/activities/__tests__/index.test.ts`
6. `packages/backend/src/features/activities/presentation/routes/data-source-activities/__tests__/index.test.ts`

## 作業メモ

- なし

## 懸念事項

- なし
