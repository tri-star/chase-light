# CHASE-185: ActivityルートのDI簡素化とテスト初期化の改善 - 作業ログ

**作成日**: 2025-12-12
**SOW**: docs/sow/20251212-CHASE-185.md

## 実装計画

### Phase 1: 型定義と依存組み立て関数の実装

- [ ] 1-1. `activity-deps.types.ts` の作成（型定義）
- [ ] 1-2. `activity-deps.ts` の作成（buildActivityDeps関数）
- [ ] 1-3. `application/index.ts` の更新（エクスポート追加）
- [ ] 1-4. format, lint, test実行
- [ ] 1-5. コミット

### Phase 2: ルート関数のシグネチャ変更

- [ ] 2-1. `routes.ts` の `createActivityPresentationRoutes` シグネチャ変更
- [ ] 2-2. 内部でbuildActivityDepsを呼び出すよう変更
- [ ] 2-3. `features/activities/index.ts` の更新（本番コードでbuildActivityDeps使用）
- [ ] 2-4. format, lint, test実行
- [ ] 2-5. コミット

### Phase 3: テストヘルパーの作成と既存テストのリファクタリング

- [ ] 3-1. `test-helpers/create-activity-test-app.ts` の作成
- [ ] 3-2. `activities/__tests__/index.test.ts` のリファクタリング
- [ ] 3-3. `activities/__tests__/translation.test.ts` のリファクタリング
- [ ] 3-4. `data-source-activities/__tests__/index.test.ts` のリファクタリング
- [ ] 3-5. format, lint, test実行
- [ ] 3-6. コミット

### Phase 4: 最終確認とプッシュ・PR作成

- [ ] 4-1. 全テスト実行 (`pnpm --filter backend test`)
- [ ] 4-2. format, lint実行
- [ ] 4-3. ブランチの確認・作成 (`feature/CHASE-185`)
- [ ] 4-4. 最終コミット（必要な場合）
- [ ] 4-5. push
- [ ] 4-6. PR作成

## 実装の詳細

### Phase 1: 完了内容

✅ 完了

- `activity-deps.types.ts` 作成: ActivityAdapters, ActivityUseCases, ActivityDeps, ActivityDepsOverrides の型定義を追加
- `activity-deps.ts` 作成: buildActivityDeps関数を実装し、デフォルトの依存関係を構築
- `application/index.ts` 更新: 新しい型と関数をエクスポート
- format, lint, test実行: 全て成功

### Phase 2: 完了内容

(作業中に記録)

### Phase 3: 完了内容

(作業中に記録)

### Phase 4: 完了内容

(作業中に記録)

## 懸念事項・メモ

(作業中に発生した問題や気づきを記録)
