# 定数管理ガイドライン

## ステータス

決定済み

## コンテキスト

TypeScript + Hono + Drizzle で構成されたAPIサーバーにおいて、数値、リスト、文字列などの値を定数化することで、保守性とコードの一貫性を向上させる必要がある。マジックナンバーやハードコードされた文字列の使用を防ぎ、変更時の影響範囲を最小化し、コードの可読性を高める。

### 主要な課題

- マジックナンバーや文字列リテラルの散在
- 同じ意味の値が複数箇所で重複定義
- 変更時の修正漏れによるバグの発生
- バリデーション制約やデフォルト値の管理の分散化
- 定数の命名規約と配置ルールの不統一

## 決定

### 採用する定数管理アプローチ

**機能単位での定数管理 + 一元化されたエクスポート**

機能ごとに`constants/`フォルダを作成し、用途別に定数ファイルを分類・管理する。関連する定数を物理的に近い場所に配置し、統一されたエクスポートパターンを採用する。

## 定数化の基本原則

### 1. 定数化すべき値の判定基準

**必須（MUST）**

- 数値リテラル（0, 1, -1 などの明白な値を除く）
- 文字列リテラル（空文字列 "" を除く）
- 配列・オブジェクトリテラル
- 正規表現パターン
- エラーメッセージ
- デフォルト値

**推奨（SHOULD）**

- 環境固有の設定値

**例外（明示的に定数化不要）**

- HTTPステータスコード(200, 404 など)
- Boolean値（`true`, `false`）
- 明白な数値（`0`, `1`, `-1`）
- 空文字列（`""`）
- `null`, `undefined`

### 2. 定数の命名規約

既存コードでの例：

- `packages/backend/src/features/user/constants/*.ts`
  - features/[feature]/constants 配下に作成している点を参考にする
  - ファイルをどのように分割しているかを参考にする
  - 宣言方法などを参考にする

## コードレビューチェックリスト

- [ ] ハードコードされた数値・文字列が定数化されているか
- [ ] 定数名が意味を表現しており、命名規約に従っているか
- [ ] `as const` アサーションが適切に使用されているか
- [ ] 同じ意味の値が重複定義されていないか
- [ ] 定数が適切なフォルダ・ファイルに配置されているか
- [ ] エクスポート/インポートが統一されたパターンに従っているか
- [ ] 型安全性が確保されているか
- [ ] 必要に応じて JSDoc コメントが記述されているか
